(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[310],{8580:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cartelle",function(){return a(4215)}])},896:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var n=a(5893),r=a(7294),l=a(9876),o=a(2559);function i(){var e=(0,r.useState)(!1),t=e[0],a=e[1];(0,r.useEffect)((function(){var e=localStorage.getItem("tombola_muted");null!==e&&a("true"===e)}),[]);return(0,n.jsxs)("button",{onClick:function(){var e=!t;a(e),localStorage.setItem("tombola_muted",e.toString())},className:"bg-white bg-opacity-10 hover:bg-opacity-20 text-white p-2 md:px-4 md:py-2 rounded-xl md:rounded-2xl font-bold transition-all flex items-center gap-1 md:gap-2 shadow-xl active:scale-95","aria-label":t?"Attiva suoni":"Disattiva suoni",children:[t?(0,n.jsx)(l.Z,{className:"w-4 h-4 md:w-5 md:h-5"}):(0,n.jsx)(o.Z,{className:"w-4 h-4 md:w-5 md:h-5"}),(0,n.jsx)("span",{className:"hidden md:block",children:t?"Suoni Off":"Suoni On"})]})}},4215:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return w}});var n=a(9815),r=a(5893),l=a(7294),o=a(1163),i=a(7642),s=function(){for(var e=function(e){var n=0,r=[0,1,2,3,4,5,6,7,8].sort((function(){return Math.random()-.5})),l=!0,o=!1,i=void 0;try{for(var s,d=r[Symbol.iterator]();!(l=(s=d.next()).done);l=!0){var c=s.value;n<5&&a[c].length>0&&(t[e][c]=a[c].pop(),n++)}}catch(m){o=!0,i=m}finally{try{l||null==d.return||d.return()}finally{if(o)throw i}}},t=Array.from({length:3},(function(){return Array(9).fill(null)})),a=Array.from({length:9},(function(e,t){for(var a=8===t?90:10*t+9,n=[],r=0===t?1:10*t;r<=a;r++)n.push(r);return n.sort((function(){return Math.random()-.5}))})),n=0;n<3;n++)e(n);return t},d=a(1470),c=a(1373);const m=(0,c.Z)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),u=(0,c.Z)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),x=(0,c.Z)("mouse-pointer-click",[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]]);var f=a(6330),b=a(9883);function h(e){var t=e.isOpen,a=e.onClose,n=(0,o.useRouter)();return(0,l.useEffect)((function(){if(t){var e=setTimeout((function(){a(),n.push("/")}),5e3);return function(){return clearTimeout(e)}}}),[t,a,n]),t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-70 animate-in fade-in duration-300 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"bg-white p-6 md:p-8 rounded-3xl shadow-[0_20px_50px_rgba(0,0,0,0.3)] w-full max-w-md border border-white border-opacity-20 z-10 text-center",children:[(0,r.jsx)("h2",{className:"text-2xl md:text-3xl font-black text-red-900 uppercase italic mb-4",children:"Partita Abbandonata"}),(0,r.jsx)("p",{className:"text-lg md:text-xl font-bold text-red-800 mb-6",children:"Il Tombolone ha abbandonato la partita. Verrai reindirizzato alla pagina iniziale."}),(0,r.jsx)("button",{onClick:function(){a(),n.push("/")},className:"bg-green-600 hover:bg-green-500 text-white px-6 py-3 rounded-2xl font-bold transition-all shadow-xl active:scale-95",children:"OK"})]})}):null}var p,g=a(896);function w(){var e=(0,o.useRouter)(),t=e.query,a=t.num,c=t.name,w=(0,l.useState)([]),v=w[0],y=w[1],j=(0,l.useState)([]),N=j[0],k=j[1],_=(0,l.useState)([]),S=_[0],I=_[1],A=(0,l.useState)(null),Z=A[0],C=A[1],T=(0,l.useState)(!1),z=T[0],E=T[1],M=(0,l.useState)("auto"),O=M[0],q=M[1],G=(0,l.useState)([]),P=G[0],R=G[1],V=(0,l.useState)([]),F=V[0],J=V[1],L=(0,l.useState)(null),X=L[0],D=L[1],K=["ambo","terna","quaterna","cinquina","tombola"],B=function(e,t,a,n){!function(e){if("true"!==localStorage.getItem("tombola_muted")){var t=window.AudioContext||window.webkitAudioContext;if(t){var a=new t,n=a.createOscillator(),r=a.createGain();n.connect(r),r.connect(a.destination);var l={ambo:[440,554],terna:[440,554,659],quaterna:[523,659,783,1046],cinquina:[523,659,783,1046,1318],tombola:[523,659,783,1046,1318,1567]}[e]||[440],o=a.currentTime;l.forEach((function(e,t){n.frequency.setValueAtTime(e,o+.1*t)})),r.gain.setValueAtTime(.1,o),r.gain.exponentialRampToValueAtTime(1e-4,o+1),n.start(o),n.stop(o+1)}}}(e),C({goal:e,winner:t}),J(a||[]),D(n),setTimeout((function(){return C(null)}),5e3),(0,b.Z)({particleCount:150,spread:70,origin:{y:.6},colors:["#ff0000","#00ff00","#ffffff","#ffd700"]})},H=(0,l.useCallback)((function(){return"auto"===O?N:P}),[O,N,P]),Q=(0,l.useCallback)((function(){var e=S.length;if(!(e>=K.length)){var t=K[e],a=!1,r=[],l=null,o=H();v.forEach((function(e){var i,s=[];e.nums.forEach((function(e){var t=e.filter((function(e){return e&&o.includes(e)}));s.push(t)}));var d=(i=Math).max.apply(i,(0,n.Z)(s.map((function(e){return e.length}))));if({ambo:d>=2,terna:d>=3,quaterna:d>=4,cinquina:d>=5,tombola:15===s.flat().length}[t])if(a=!0,l=e.id,"tombola"===t)r=s.flat();else{var c=s.find((function(e){return e.length>=K.indexOf(t)+2}));r=c||[]}})),a&&p.emit("claim-goal",{goal:t,name:c,numbers:r,cardId:l,isTombolone:!1})}}),[v,H,S,c]);(0,l.useEffect)((function(){Q()}),[N,P,Q]);var U=(0,l.useState)(c||""),W=U[0],Y=U[1];return(0,l.useEffect)((function(){var e=localStorage.getItem("tombola_cards"),t=localStorage.getItem("tombola_name");if(!e||c&&c!==t){if(a){for(var n=parseInt(a)||1,r=new Set,l=[],o=0;o<n;o++){var i=void 0;do{i=Math.floor(1e4*Math.random())}while(r.has(i));r.add(i),l.push({id:i,nums:s()})}y(l),localStorage.setItem("tombola_cards",JSON.stringify(l)),localStorage.setItem("tombola_name",c),localStorage.setItem("tombola_role","player"),Y(c)}}else y(JSON.parse(e)),t&&Y(t)}),[a,c]),(0,l.useEffect)((function(){p=(0,i.ZP)({transports:["websocket"]});var t=c||localStorage.getItem("tombola_name"),r=a||JSON.parse(localStorage.getItem("tombola_cards")||"[]").length;if(t)return p.on("init-state",(function(e){if(k(e.drawnNumbers),I(e.claimedGoals.map((function(e){return e.goal}))),e.claimedGoals.length>0){var a=e.claimedGoals[e.claimedGoals.length-1];a.winner===(c||localStorage.getItem("tombola_name"))&&(J(a.numbers||[]),D(a.cardId))}p.emit("join-as-player",{name:t,numCards:r})})),p.on("number-drawn",(function(e){k((function(t){return(0,n.Z)(new Set((0,n.Z)(t).concat([e])))}))})),p.on("goal-claimed",(function(e){I((function(t){return(0,n.Z)(t).concat([e.goal])}));var t=c||localStorage.getItem("tombola_name");e.winner===t?B(e.goal,e.winner,e.numbers,e.cardId):B(e.goal,e.winner,[],null)})),p.on("game-reset",(function(){k([]),I([]),J([]),D(null),localStorage.removeItem("tombola_cards"),localStorage.removeItem("tombola_name"),localStorage.removeItem("tombola_role")})),p.on("tombolone-abandoned",(function(){E(!0),localStorage.removeItem("tombola_cards"),localStorage.removeItem("tombola_name"),localStorage.removeItem("tombola_role")})),p.on("player-left",(function(t){t.name===W&&e.push("/")})),function(){return p.disconnect()}}),[c,a]),(0,r.jsxs)("div",{className:"min-h-screen p-4 bg-gradient-to-b from-green-900 to-red-900 flex flex-col items-center relative md:pb-20 pb-[2rem]",children:[Z&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-70 animate-in fade-in duration-300 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"bg-yellow-400 p-6 md:p-10 rounded-[2rem] md:rounded-[3rem] border-8 border-white shadow-2xl text-center transform animate-in zoom-in duration-500 w-full max-w-md md:max-w-2xl",children:[(0,r.jsx)(d.Z,{className:"w-16 h-16 md:w-24 md:h-24 text-red-600 mx-auto mb-4 md:mb-6 animate-bounce"}),(0,r.jsxs)("h2",{className:"text-3xl md:text-5xl font-black text-red-900 uppercase italic mb-2",children:[Z.goal,"!"]}),(0,r.jsx)("p",{className:"text-lg md:text-2xl font-bold text-red-800",children:"Il vincitore \xe8:"}),(0,r.jsx)("p",{className:"text-4xl md:text-6xl font-black text-green-700 mt-2 md:mt-4 drop-shadow-sm break-words",children:Z.winner})]})}),(0,r.jsxs)("div",{className:"w-full max-w-4xl flex justify-between items-center mb-10 bg-white bg-opacity-10 backdrop-blur-md p-4 rounded-3xl border border-white border-opacity-10",children:[(0,r.jsx)("div",{className:"flex flex-col",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(m,{className:"text-yellow-400 fill-current w-6 h-6 animate-pulse"}),(0,r.jsxs)("h1",{className:"text-2xl md:text-4xl font-black text-yellow-400 italic tracking-tighter uppercase",children:["Gara di ",W]})]})}),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsxs)("button",{onClick:function(){var e="auto"===O?"manual":"auto";q(e),R("auto"===e?[]:(0,n.Z)(N))},className:"bg-white bg-opacity-10 hover:bg-opacity-20 text-white p-2 md:px-4 md:py-2 rounded-xl md:rounded-2xl font-bold transition-all flex items-center gap-1 md:gap-2 shadow-xl active:scale-95",title:"auto"===O?"Passa a Manuale":"Passa ad Automatico",children:["auto"===O?(0,r.jsx)(u,{className:"w-4 h-4 md:w-5 md:h-5 text-yellow-400"}):(0,r.jsx)(x,{className:"w-4 h-4 md:w-5 md:h-5 text-blue-400"}),(0,r.jsx)("span",{className:"hidden md:block",children:"auto"===O?"Auto":"Manual"})]}),(0,r.jsx)(g.Z,{}),(0,r.jsx)("button",{onClick:function(){return e.push("/")},className:"bg-white bg-opacity-10 hover:bg-opacity-20 text-white p-3 rounded-2xl transition-all active:scale-95",children:(0,r.jsx)(f.Z,{className:"w-6 h-6"})})]})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-8 w-full max-w-4xl mb-20 z-20",children:v.map((function(e){return(0,r.jsxs)("div",{className:"bg-white rounded-[2rem] md:rounded-[3rem] shadow-xl relative overflow-hidden group transform transition-all",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-red-600 to-red-700 h-12 md:h-16 flex items-center px-5 md:px-8 justify-between shadow-xl border-b-4 border-red-800",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 md:gap-3",children:[(0,r.jsx)("div",{className:"w-3 h-3 md:w-4 md:h-4 bg-yellow-400 rounded-full shadow-[0_0_10px_rgba(250,204,21,0.8)]"}),(0,r.jsx)("span",{className:"text-white font-black text-lg md:text-xl italic uppercase tracking-tighter",children:"Tabella Fortunata"})]}),(0,r.jsxs)("div",{className:"bg-white text-red-600 px-2 py-1 md:px-6 md:py-1.5 rounded-[1rem] md:rounded-[1.5rem] font-black text-lg md:text-xl shadow-[0_4px_0_rgba(0,0,0,0.1)] flex items-center gap-1 md:gap-2 border-2 border-red-100",children:["#",e.id]})]}),(0,r.jsx)("div",{className:"p-4 md:p-8",children:(0,r.jsx)("div",{className:"grid grid-rows-3 gap-2 md:gap-4",children:e.nums.map((function(t,a){return(0,r.jsx)("div",{className:"grid grid-cols-9 gap-1 md:gap-2",children:t.map((function(t,a){var l=H().includes(t),o="manual"===O&&N.includes(t)&&!l;return(0,r.jsx)("div",{onClick:function(){return function(e){"auto"!==O&&e&&N.includes(e)&&R((function(t){return t.includes(e)?t.filter((function(t){return t!==e})):(0,n.Z)(t).concat([e])}))}(t)},className:"aspect-square flex items-center justify-center border-b-2 md:border-b-4 border-r-2 text-base md:text-xl font-black rounded-lg md:rounded-2xl transition-all duration-300 ".concat(null===t?"bg-gray-50 border-gray-200":l?X===e.id&&F.includes(t)?"bg-green-600 text-white border-green-800 scale-110 shadow-xl rotate-3 -translate-y-1":"bg-red-600 text-white border-red-800 scale-105 shadow-xl rotate-2 -translate-y-1":o?"bg-yellow-100 text-gray-800 border-yellow-300 cursor-pointer animate-pulse":"bg-white text-gray-800 border-gray-200 hover:border-red-300 hover:bg-red-50"," ").concat("manual"===O&&null!==t&&N.includes(t)?"cursor-pointer":""),children:t},a)}))},a)}))})})]},e.id)}))}),(0,r.jsx)("div",{className:"fixed bottom-4 w-[95%] max-w-4xl z-30",children:(0,r.jsxs)("div",{className:"bg-yellow-400 p-3 md:p-6 rounded-[2rem] md:rounded-[2.5rem] shadow-[0_15px_30px_rgba(0,0,0,0.3)] border-4 border-white flex flex-col md:flex-row items-center justify-between gap-3 md:gap-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 md:gap-4",children:[(0,r.jsx)("div",{className:"bg-red-600 text-white w-10 h-10 md:w-16 md:h-16 rounded-xl md:rounded-3xl flex items-center justify-center text-xl md:text-4xl font-black shadow-lg animate-bounce",children:N[N.length-1]||"0"}),(0,r.jsxs)("div",{className:"flex flex-col md:hidden",children:[(0,r.jsx)("span",{className:"text-red-900 text-xs font-black uppercase tracking-tighter",children:"Prossimo Premio:"}),(0,r.jsx)("span",{className:"text-red-900 text-sm font-bold italic uppercase",children:K[S.length]||"GARA FINITA!"})]}),(0,r.jsx)("span",{className:"hidden md:block text-red-900 text-xl font-bold italic uppercase",children:K[S.length]||"GARA FINITA!"})]}),(0,r.jsx)("div",{className:"hidden md:flex gap-2 overflow-x-auto w-full md:w-auto pb-2 md:pb-0 no-scrollbar",children:K.map((function(e){var t=S.includes(e),a=K[S.length]===e;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center min-w-[70px] md:min-w-[80px] p-2 rounded-xl md:rounded-2xl border-2 transition-all ".concat(t?"bg-green-600 border-green-400 text-white shadow-lg":a?"bg-white border-red-600 text-red-600 animate-pulse":"bg-white bg-opacity-20 border-red-900 border-opacity-10 text-red-900 opacity-40"),children:[t&&(0,r.jsx)(d.Z,{className:"w-4 h-4 mb-1"}),(0,r.jsx)("span",{className:"text-[10px] font-black uppercase tracking-tighter",children:e})]},e)}))})]})}),(0,r.jsx)(h,{isOpen:z,onClose:function(){return E(!1)}})]})}}},function(e){e.O(0,[416,658,774,888,179],(function(){return t=8580,e(e.s=t);var t}));var t=e.O();_N_E=t}]);